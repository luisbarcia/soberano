{{/* layouts/partials/footer.html */}}
{{/* Footer partial. Social from site.Params.social (SVG icons), nav from site.Menus.footer. */}}

<footer class="site-footer">
  <div class="container">

    {{/* Social links row — SVG icons with sr-only labels */}}
    {{ $privacyMode := site.Params.privacy.mode | default "standard" }}
    {{ with site.Params.social }}
    {{ if ne $privacyMode "paranoid" }}
    <nav class="site-footer__social" aria-label="{{ T "socialLinks" }}">

      {{ with .email }}
      <a href="mailto:{{ . }}" title="Email">
        {{ partial "icons/email.html" }}
        <span class="sr-only">Email</span>
      </a>
      {{ end }}

      {{ with .github }}
      <a href="https://github.com/{{ . }}" target="_blank" rel="noopener noreferrer" title="GitHub">
        {{ partial "icons/github.html" }}
        <span class="sr-only">GitHub</span>
      </a>
      {{ end }}

      {{ with .nostr }}
      <a href="https://njump.me/{{ . }}" target="_blank" rel="noopener noreferrer" title="Nostr">
        {{ partial "icons/nostr.html" }}
        <span class="sr-only">Nostr</span>
      </a>
      {{ end }}

      {{ with .mastodon }}
      <a href="{{ . }}" target="_blank" rel="me noopener noreferrer" title="Mastodon">
        {{ partial "icons/mastodon.html" }}
        <span class="sr-only">Mastodon</span>
      </a>
      {{ end }}

      {{ with .linkedin }}
      <a href="https://linkedin.com/in/{{ . }}" target="_blank" rel="noopener noreferrer" title="LinkedIn">
        {{ partial "icons/linkedin.html" }}
        <span class="sr-only">LinkedIn</span>
      </a>
      {{ end }}

      {{ with .twitter }}
      <a href="https://twitter.com/{{ . }}" target="_blank" rel="noopener noreferrer" title="X (Twitter)">
        {{ partial "icons/twitter.html" }}
        <span class="sr-only">X (Twitter)</span>
      </a>
      {{ end }}

      {{ with .signal }}
      <a href="https://signal.me/#p/{{ . }}" target="_blank" rel="noopener noreferrer" title="Signal">
        {{ partial "icons/signal.html" }}
        <span class="sr-only">Signal</span>
      </a>
      {{ end }}

      {{ with .matrix }}
      <a href="https://matrix.to/#/{{ . }}" target="_blank" rel="noopener noreferrer" title="Matrix">
        {{ partial "icons/matrix.html" }}
        <span class="sr-only">Matrix</span>
      </a>
      {{ end }}

      {{ with .xmpp }}
      <a href="xmpp:{{ . }}" target="_blank" rel="noopener noreferrer" title="XMPP">
        {{ partial "icons/xmpp.html" }}
        <span class="sr-only">XMPP</span>
      </a>
      {{ end }}

      {{ with .simplex }}
      <a href="{{ . }}" target="_blank" rel="noopener noreferrer" title="SimpleX">
        {{ partial "icons/simplex.html" }}
        <span class="sr-only">SimpleX</span>
      </a>
      {{ end }}

    </nav>
    {{ else }}
    {{/* Paranoid mode: only pseudonymous/federated networks */}}
    {{ if or .nostr .matrix .mastodon .xmpp .simplex }}
    <nav class="site-footer__social" aria-label="{{ T "socialLinks" }}">
      {{ with .nostr }}
      <a href="https://njump.me/{{ . }}" target="_blank" rel="noopener noreferrer" title="Nostr">
        {{ partial "icons/nostr.html" }}
        <span class="sr-only">Nostr</span>
      </a>
      {{ end }}
      {{ with .matrix }}
      <a href="https://matrix.to/#/{{ . }}" target="_blank" rel="noopener noreferrer" title="Matrix">
        {{ partial "icons/matrix.html" }}
        <span class="sr-only">Matrix</span>
      </a>
      {{ end }}
      {{ with .mastodon }}
      <a href="{{ . }}" target="_blank" rel="me noopener noreferrer" title="Mastodon">
        {{ partial "icons/mastodon.html" }}
        <span class="sr-only">Mastodon</span>
      </a>
      {{ end }}
      {{ with .xmpp }}
      <a href="xmpp:{{ . }}" target="_blank" rel="noopener noreferrer" title="XMPP">
        {{ partial "icons/xmpp.html" }}
        <span class="sr-only">XMPP</span>
      </a>
      {{ end }}
      {{ with .simplex }}
      <a href="{{ . }}" target="_blank" rel="noopener noreferrer" title="SimpleX">
        {{ partial "icons/simplex.html" }}
        <span class="sr-only">SimpleX</span>
      </a>
      {{ end }}
    </nav>
    {{ end }}
    {{ end }}{{/* end privacy mode check */}}
    {{ end }}

    {{/* Navigation row — from menu "footer" */}}
    {{ with site.Menus.footer }}
    <nav class="site-footer__nav" aria-label="{{ T "footerNav" }}">
      {{ range $i, $item := . }}
        {{ if $i }}<span aria-hidden="true">·</span>{{ end }}
        <a href="{{ .URL | relURL }}"
           {{ if .Params.external }}target="_blank" rel="noopener noreferrer"{{ end }}>
          {{ .Name }}
        </a>
      {{ end }}
    </nav>
    {{ end }}

    {{/* Sovereignty indicators — public transparency badges */}}
    {{ $hasSovereignty := or
      (site.GetPage "/canary")
      (site.GetPage "/integrity")
      (site.Params.sovereignty.onion_url)
      (site.Params.sovereignty.ipfs_cid)
      (site.Params.crypto.pgp_fingerprint)
      (site.Params.nostr.pubkey)
    }}
    {{ if $hasSovereignty }}
    <div class="site-footer__sovereignty">
      {{/* Canary — link only, no status judgment */}}
      {{ with site.GetPage "/canary" }}
        <a href="{{ .RelPermalink }}" class="sovereignty-badge">
          <span class="sovereignty-badge__dot"></span>
          {{ T "sovereigntyCanary" }}
        </a>
      {{ end }}
      {{/* Onion */}}
      {{ with site.Params.sovereignty }}{{ with .onion_url }}
      <span class="sovereignty-badge">
        <span class="sovereignty-badge__dot"></span>
        {{ T "sovereigntyOnion" }}
      </span>
      {{ end }}{{ end }}
      {{/* IPFS */}}
      {{ with site.Params.sovereignty }}{{ with .ipfs_cid }}
      <span class="sovereignty-badge">
        <span class="sovereignty-badge__dot"></span>
        {{ T "sovereigntyIPFS" }}
      </span>
      {{ end }}{{ end }}
      {{/* PGP */}}
      {{ with site.Params.crypto }}{{ with .pgp_fingerprint }}
        {{ $pgpURL := site.Params.crypto.pgp_key_url }}
        {{ if $pgpURL }}
        <a href="{{ $pgpURL | relURL }}" class="sovereignty-badge">
          <span class="sovereignty-badge__dot"></span>
          {{ T "sovereigntyPGP" }}
        </a>
        {{ else }}
        <span class="sovereignty-badge">
          <span class="sovereignty-badge__dot"></span>
          {{ T "sovereigntyPGP" }}
        </span>
        {{ end }}
      {{ end }}{{ end }}
      {{/* Integrity manifest */}}
      {{ with site.GetPage "/integrity" }}
      <a href="{{ .RelPermalink }}" class="sovereignty-badge">
        <span class="sovereignty-badge__dot"></span>
        {{ T "sovereigntyIntegrity" | default "Integrity" }}
      </a>
      {{ end }}
      {{/* NIP-05 */}}
      {{ with site.Params.nostr }}{{ with .pubkey }}
      <a href="https://njump.me/{{ . }}" target="_blank" rel="noopener noreferrer" class="sovereignty-badge">
        <span class="sovereignty-badge__dot"></span>
        {{ T "sovereigntyNIP05" }}
      </a>
      {{ end }}{{ end }}
    </div>
    {{ end }}

    {{/* Copyright row — theme attribution (suppressed in paranoid mode) */}}
    <div class="site-footer__inner">
      {{ if ne $privacyMode "paranoid" }}
      <span>
        <a class="site-footer__theme-link" href="https://github.com/luisbarcia/soberano" target="_blank" rel="noopener noreferrer">Soberano</a> · {{ now.Year }}
      </span>
      {{ else }}
      <span>{{ now.Year }}</span>
      {{ end }}
    </div>

    {{ if ne $privacyMode "paranoid" }}
    {{ with site.Params.crypto }}{{ with .pgp_fingerprint }}
    <div class="site-footer__pgp">{{ T "pgpLabel" }}: {{ . }}</div>
    {{ end }}{{ end }}
    {{ end }}

  </div>
</footer>
